<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>UsoJaleco | Briefing PowerPoint</title>
  <style>
    :root{
      --bg:#0a0b0f;
      --card:#12141b;
      --card2:#171a23;
      --muted:#9aa4b2;
      --text:#e6e9ef;
      --line:#232838;
      
      --orange1:#ff7a18;
      --orange2:#ffb703;

      --good:#22c55e;
      --warn:#f59e0b;
      --bad:#ef4444;
      --req:#ff3b3b;
    }
    *{box-sizing:border-box}

    html {
      min-height: 100%;
      height: auto;
      overflow-x: hidden;
    }

    body {
      min-height: 100vh;
      height: auto;
      margin: 0;
      padding: 18px;
      overflow-x: hidden;
      overflow-y: visible;
      position: static;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      -webkit-overflow-scrolling: touch;
    }

    .wrap{
      max-width:980px;
      margin:0 auto;
      position: relative;
    }

    .btn, details summary, .social a, .goPay, .stepCard, .option {
      touch-action: manipulation;
    }

    /* ===== NAV ===== */
    .navBar{
      background: linear-gradient(180deg, rgba(18,20,27,.92), rgba(10,11,15,.88));
      border:1px solid rgba(255,255,255,.08);
      border-radius:18px;
      padding:12px 14px;
      box-shadow: 0 12px 30px rgba(0,0,0,.28);
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:space-between;
      margin-bottom:12px;
      overflow:hidden;
    }

    .navLeft{
      display:flex; align-items:center; gap:12px;
      min-width: 220px;
    }
    .logoMark{
      width:40px;height:40px;border-radius:14px;
      display:flex;align-items:center;justify-content:center;
      color:#0a0b0f;
      font-weight:950;
      letter-spacing:.5px;
      background: linear-gradient(135deg,var(--orange1),var(--orange2));
      box-shadow: 0 10px 24px rgba(0,0,0,.35);
      flex:0 0 auto;
    }

    .brandText{ display:inline-block; width:max-content; line-height:1.05; }
    .brandName{ font-size:18px; font-weight:900; letter-spacing:.2px; margin:0; }
    .brandSub{ margin-top:5px; width:100%; color:rgba(230,233,239,.78); font-size:11px; font-weight:500; display:block; }

    .navRight{
      display:flex;
      align-items:center;
      justify-content:flex-end;
      gap:10px;
      min-width: 100px;
    }

    /* REDES SOCIAIS */
    .social{
      display:flex; align-items:center; gap:8px;
    }
    .social a{
      width:34px;height:34px;
      border-radius:12px;
      display:flex; align-items:center; justify-content:center;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      transition: border-color .15s ease, background .15s ease;
      text-decoration:none;
    }
    .social a:hover{
      border-color: rgba(255,122,24,.55);
      background: rgba(255,122,24,.08);
    }
    .social svg{display:block}

    /* ===== CARD BASE ===== */
    .card{
      background:linear-gradient(180deg,var(--card), var(--card2));
      border:1px solid var(--line);
      border-radius:18px;
      padding:16px;
      box-shadow: 0 10px 30px rgba(0,0,0,.25);
      margin-bottom:14px;
    }

    /* ===== TOPO (Steps apenas) ===== */
    .topPanel{
      padding:14px;
      display:flex;
      justify-content:center;
    }

    .stepsBar{
      display:grid;
      grid-template-columns:repeat(7, minmax(0, 1fr));
      gap:6px;
      align-items:stretch;
      width:100%;
      overflow:visible;
    }

    .stepCard{
      border-radius:16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      padding:8px;
      cursor:pointer;
      user-select:none;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap:4px;
      transition: border-color .15s ease, background .15s ease;
      min-width:0;
    }
    .stepCard:hover{ border-color: rgba(255,122,24,.55); }
    .stepCard.on{
      border-color: rgba(255,122,24,.70);
      background: rgba(255,122,24,.08);
    }

    .stepIco{
      width:32px;height:32px;
      border-radius:12px;
      display:flex;align-items:center;justify-content:center;
      background: transparent;
      border:1px solid rgba(255,122,24,.40);
      box-shadow: inset 0 0 0 1px rgba(0,0,0,.10);
    }
    .stepIco svg{
      width:16px;height:16px;
      stroke: url(#stepGrad);
    }

    .stepTitle{ font-size:10px; font-weight:900; letter-spacing:.15px; text-align:center; margin:0; line-height:1.1; color:#e6e9ef; }

    /* ===== CONTE√öDO ===== */
    .h{display:flex;align-items:flex-start;justify-content:space-between;gap:10px;margin-bottom:10px;}
    .h h2{margin:0;font-size:15px;letter-spacing:.2px;}
    .h span{color:var(--muted);font-size:12px;line-height:1.35;text-align:right;}
    .grid{display:grid;grid-template-columns:repeat(2, minmax(0,1fr));gap:10px;}

    .option{
      position:relative;
      border:1px solid var(--line);
      border-radius:16px;
      padding:12px 12px 12px 44px;
      background:rgba(255,255,255,.03);
      cursor:pointer;
      transition: border-color .15s ease;
      min-height:50px;
      display:flex;flex-direction:column;justify-content:center;gap:2px;
    }
    .option:hover{ border-color:rgba(255,122,24,.55)}
    .option input{
      position:absolute;left:12px;top:50%;
      transform:translateY(-50%);
      width:18px;height:18px;
      accent-color:var(--orange1);
    }
    .option .t{font-weight:650;font-size:13px;}
    .option .d{color:var(--muted);font-size:11px;}

    label.small{display:block;color:var(--muted);font-size:12px;margin:10px 0 6px;}
    .req{color:var(--req); font-weight:800; margin-left:6px;}

    input[type="text"], input[type="email"], input[type="date"], textarea, select, input[type="number"]{
      width:100%;
      padding:11px 12px;
      border-radius:14px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      color:var(--text);
      outline:none;
      font-size:16px;
      line-height:1.2;
    }
    /* Input de cor */
    input[type="color"] {
      padding: 0; border: none; background: transparent; height: 40px; cursor: pointer;
    }
    
    .hiddenInput { display: none; margin-top: 8px; }
    .hiddenInput.show { display: block; animation: fadeIn 0.3s ease; }

    @keyframes fadeIn { from { opacity:0; transform:translateY(-5px); } to { opacity:1; transform:translateY(0); } }

    textarea{min-height:92px; resize:vertical}
    input:focus, textarea:focus, select:focus{border-color:rgba(255,122,24,.55)}
    .muted{color:var(--muted); font-size:12px; line-height:1.45}

    .actions{
      display:flex;gap:12px;justify-content:space-between;align-items:center;flex-wrap:wrap;
      margin-top:12px;
    }
    .btn{
      border:1px solid var(--line);
      background:rgba(255,255,255,.04);
      color:var(--text);
      padding:10px 12px;
      border-radius:14px;
      cursor:pointer;
      font-weight:650;
      font-size:13px;
      user-select:none;
    }
    .btn:hover{ border-color:rgba(255,122,24,.60)}
    .btn.primary{
      color:#0a0b0f;
      border-color:rgba(255,122,24,.0);
      background:linear-gradient(135deg,var(--orange1),var(--orange2));
    }
    .btn:disabled{opacity:.5;cursor:not-allowed;}

    .summary{
      border:1px dashed rgba(255,255,255,.18);
      border-radius:16px;
      padding:12px;
      background:rgba(255,255,255,.02);
      white-space:pre-wrap;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size:12px;line-height:1.45;
      margin-top:12px;
      color: rgba(255,255,255,0.85);
    }

    .tag{
      display:inline-flex;align-items:center;gap:6px;
      padding:6px 10px;border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.03);
      color:var(--muted);
      font-size:12px;
    }
    .tag.orange{ border-color:rgba(255,122,24,.45); background:rgba(255,122,24,.10); }
    .tag b{color:var(--text)}

    /* MOBILE ADAPTATION */
    @media (max-width: 860px){
      .navBar{flex-wrap:wrap; gap:10px}
      .navLeft{min-width:auto}
      .navRight{min-width:auto}
    }

    @media (max-width: 780px){
      .grid{grid-template-columns:1fr}
      .topPanel{flex-direction:column}
    }

    @media (max-width: 560px){
      body{ padding:12px; }
      .stepsBar{ gap:4px; }
      .stepCard{ padding:6px 4px; min-height:40px; }
      .stepTitle{ display:none; } /* √çcones apenas no mobile */
      .topPanel svg{ pointer-events: none; }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header class="navBar">
      <div class="navLeft">
        <div class="logoMark">UJ</div>
        <div class="brandText">
          <div class="brandName">UsoJaleco</div>
          <span class="brandSub">Prontu√°rio de Apresenta√ß√£o</span>
        </div>
      </div>

      <div class="navRight">
        <div class="social" aria-label="Redes sociais">
          <a href="https://www.instagram.com/usojaleco_/" target="_blank" rel="noopener noreferrer" aria-label="Instagram">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
              <defs>
                <linearGradient id="igGrad" x1="2" y1="22" x2="22" y2="2" gradientUnits="userSpaceOnUse">
                  <stop stop-color="#ff7a18"/>
                  <stop offset="1" stop-color="#ffb703"/>
                </linearGradient>
              </defs>
              <path d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5Z" stroke="url(#igGrad)" stroke-width="2"/>
              <path d="M12 16a4 4 0 1 0 0-8 4 4 0 0 0 0 8Z" stroke="url(#igGrad)" stroke-width="2"/>
              <path d="M17.5 6.5h.01" stroke="url(#igGrad)" stroke-width="3" stroke-linecap="round"/>
            </svg>
          </a>

          <a href="https://www.tiktok.com/@usojaleco" target="_blank" rel="noopener noreferrer" aria-label="TikTok">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
              <defs>
                <linearGradient id="ttGrad" x1="2" y1="22" x2="22" y2="2" gradientUnits="userSpaceOnUse">
                  <stop stop-color="#ff7a18"/>
                  <stop offset="1" stop-color="#ffb703"/>
                </linearGradient>
              </defs>
              <path d="M14 3v10.2a4.8 4.8 0 1 1-3.6-4.6" stroke="url(#ttGrad)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M14 6c1.2 2.3 3.2 3.7 6 3.9" stroke="url(#ttGrad)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </a>

          <a id="waIconLink" href="https://wa.me/5571981577908" target="_blank" rel="noopener noreferrer" aria-label="WhatsApp">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
              <defs>
                <linearGradient id="waGrad" x1="2" y1="22" x2="22" y2="2" gradientUnits="userSpaceOnUse">
                  <stop stop-color="#ff7a18"/>
                  <stop offset="1" stop-color="#ffb703"/>
                </linearGradient>
              </defs>
              <path d="M20 11.5a8 8 0 0 1-12.9 6.2L4 18l.4-3.1A8 8 0 1 1 20 11.5Z" stroke="url(#waGrad)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M8.6 9.4c.2-.5.5-.5.8-.5h.2c.2 0 .5 0 .6.3l.9 1.5c.1.2.1.5 0 .7l-.3.4c-.1.2-.2.4 0 .6.3.6 1.3 1.8 2.6 2.4.2.1.5.1.6-.1l.5-.6c.2-.2.5-.3.7-.2l1.6.6c.3.1.4.4.4.7 0 .8-.5 1.4-1.2 1.7-.6.3-1.4.4-2.6.1-1.6-.4-3.1-1.5-4.4-3-.9-1-1.6-2.1-1.7-3.2 0-.7.2-1.4.3-1.7Z" stroke="url(#waGrad)" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </a>
        </div>
      </div>
    </header>

    <div class="card topPanel">
      <svg width="0" height="0" style="position:absolute">
        <defs>
          <linearGradient id="stepGrad" x1="0" y1="24" x2="24" y2="0" gradientUnits="userSpaceOnUse">
            <stop stop-color="#ff7a18"/>
            <stop offset="1" stop-color="#ffb703"/>
          </linearGradient>
        </defs>
      </svg>
      <div class="stepsBar" id="steps"></div>
    </div>

    <div class="card" id="screen"></div>

    <div class="card">
      <div class="actions left">
        <button class="btn" id="resetBtn" type="button">Limpar tudo</button>
      </div>
    </div>
  </div>

<script>
(function(){
  // =========================
  // CONFIG
  // =========================
  const WHATSAPP_NUMBER_E164 = "5571981577908"; 
  const STORAGE_KEY = "usojaleco_ppt_briefing_v3";
  const PIX_KEY = "ammbrosi@gmail.com";

  const TAXAS = {
    1: "Sem juros", 2: "9,97%", 3: "11,43%", 4: "11,56%", 5: "14,51%", 
    6: "14,53%", 7: "16,93%", 8: "16,94%"
  };

  // =========================
  // STATE
  // =========================
  const defaultState = {
    step: "ID",
    
    // Identifica√ß√£o
    status: "",
    nome: "",
    email: "",
    
    // Contexto
    tipoApresentacao: "",
    tipoApresentacaoOutro: "",
    publicoAlvo: "",
    publicoAlvoOutro: "",
    nivelPublico: "",
    
    // Conte√∫do
    tema: "",
    objetivo: "",
    objetivoOutro: "",
    qtdSlides: "",
    materialBase: [], // array de strings
    
    // Design
    corDefinida: "", // yes/no
    corFundo: "#ffffff",
    corDetalhes: "#ff7a18",
    corFonte: "#000000",
    referenciaVisual: "", // yes/no
    linkReferencia: "",
    
    // Prazo
    dataEntrega: "",
    urgencia: "",
    observacoes: ""
  };

  let state = load() || JSON.parse(JSON.stringify(defaultState));

  // Elementos
  const stepsEl = document.getElementById("steps");
  const screenEl = document.getElementById("screen");
  const resetBtn = document.getElementById("resetBtn");

  resetBtn.addEventListener("click", () => {
    localStorage.removeItem(STORAGE_KEY);
    location.reload();
  });

  // =========================
  // STEPS
  // =========================
  const stepList = [
    { key:"ID",       title:"Identifica√ß√£o", icon:"user" },
    { key:"CONTEXTO", title:"Contexto",      icon:"info" },
    { key:"CONTEUDO", title:"Conte√∫do",      icon:"file" },
    { key:"DESIGN",   title:"Design",        icon:"palette" },
    { key:"PRAZO",    title:"Prazo",         icon:"clock" },
    { key:"PAYINFO",  title:"Pagamento",     icon:"card" },
    { key:"RESUMO",   title:"Revisar",       icon:"check" },
  ];

  function stepIconSvg(kind){
    const s = (d) => `<svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">${d}</svg>`;
    if (kind === "user") return s(`<path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/>`);
    if (kind === "info") return s(`<circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/>`);
    if (kind === "file") return s(`<path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/>`);
    if (kind === "palette") return s(`<path d="M12 21a9 9 0 0 0 9-9c0-3.32-2.69-6-6-6-.5 0-1 .5-1 1s.5 1 1 1h.5c1.1 0 2 .9 2 2 0 1.1-.9 2-2 2h-1c-1.1 0-2-.9-2-2 0-.5.5-1 1-1h.5c.28 0 .5-.22.5-.5V5c0-.28-.22-.5-.5-.5h-1c-3.31 0-6 2.69-6 6 0 4.97 4.03 9 9 9z"/><circle cx="8.5" cy="8.5" r="1.5"/><circle cx="15.5" cy="8.5" r="1.5"/><circle cx="8.5" cy="15.5" r="1.5"/>`);
    if (kind === "clock") return s(`<circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/>`);
    if (kind === "card") return s(`<rect x="1" y="4" width="22" height="16" rx="2" ry="2"/><line x1="1" y1="10" x2="23" y2="10"/>`);
    if (kind === "check") return s(`<path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/>`);
    return s(``);
  }

  function renderSteps(){
    stepsEl.innerHTML = "";
    stepList.forEach(s=>{
      const btn = document.createElement("button");
      btn.type = "button";
      btn.className = "stepCard" + (s.key === state.step ? " on" : "");
      btn.innerHTML = `
        <div class="stepIco">${stepIconSvg(s.icon)}</div>
        <div class="stepTitle">${s.title}</div>
      `;
      btn.addEventListener("click", () => go(s.key));
      stepsEl.appendChild(btn);
    });
  }

  function go(stepKey){
    state.step = stepKey;
    save();
    render();
  }

  function nextStep(){
    const idx = stepList.findIndex(s=>s.key===state.step);
    if (idx >= 0 && idx < stepList.length-1) go(stepList[idx+1].key);
  }
  function prevStep(){
    const idx = stepList.findIndex(s=>s.key===state.step);
    if (idx > 0) go(stepList[idx-1].key);
  }

  function save(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(state)); }
  function load(){
    try{
      const raw = localStorage.getItem(STORAGE_KEY);
      return raw ? JSON.parse(raw) : null;
    }catch(e){ return null; }
  }

  function copyPix(){
    const txt = PIX_KEY;
    if(navigator.clipboard){
      navigator.clipboard.writeText(txt).then(()=>alert("Chave PIX copiada!"), ()=>prompt("Copie a chave:", txt));
    } else {
      prompt("Copie a chave:", txt);
    }
  }

  // =========================
  // COMPONENTES
  // =========================
  function optionCard({type, name, value, checked, title, desc, onChange, id}){
    const wrap = document.createElement("label");
    wrap.className = "option";
    wrap.setAttribute("for", id);

    const input = document.createElement("input");
    input.type = type;
    input.name = name;
    input.value = value;
    input.id = id;
    input.checked = !!checked;
    input.addEventListener("change", onChange);

    const t = document.createElement("div");
    t.className = "t";
    t.textContent = title;

    if(desc){
      const d = document.createElement("div");
      d.className = "d";
      d.innerHTML = desc;
      wrap.appendChild(input);
      wrap.appendChild(t);
      wrap.appendChild(d);
    } else {
      wrap.appendChild(input);
      wrap.appendChild(t);
    }
    return wrap;
  }

  function renderHeader(title, subtitle){
    const h = document.createElement("div");
    h.className = "h";
    const left = document.createElement("h2");
    left.textContent = title;
    const right = document.createElement("span");
    right.textContent = subtitle || "";
    h.appendChild(left);
    h.appendChild(right);
    screenEl.appendChild(h);
  }

  function renderActions({canBack=true, canNext=true, nextLabel="Pr√≥ximo", backLabel="Voltar", onNext}){
    const a = document.createElement("div");
    a.className = "actions";

    const left = document.createElement("div");
    const back = document.createElement("button");
    back.type = "button";
    back.className = "btn";
    back.textContent = backLabel;
    back.disabled = !canBack;
    back.addEventListener("click", prevStep);
    left.appendChild(back);

    const right = document.createElement("div");
    const next = document.createElement("button");
    next.type = "button";
    next.className = "btn primary";
    next.textContent = nextLabel;
    next.disabled = !canNext;
    next.addEventListener("click", onNext || nextStep);
    right.appendChild(next);

    a.appendChild(left);
    a.appendChild(right);
    screenEl.appendChild(a);
  }

  // =========================
  // RENDERS
  // =========================
  function render(){
    renderSteps();
    screenEl.innerHTML = "";

    if (state.step === "ID") return renderIdentificacao();
    if (state.step === "CONTEXTO") return renderContexto();
    if (state.step === "CONTEUDO") return renderConteudo();
    if (state.step === "DESIGN") return renderDesign();
    if (state.step === "PRAZO") return renderPrazo();
    if (state.step === "PAYINFO") return renderPagamentoInfo();
    if (state.step === "RESUMO") return renderResumo();
  }

  // --- 1. IDENTIFICA√á√ÉO ---
  function renderIdentificacao(){
    renderHeader("Identifica√ß√£o B√°sica", "Vamos come√ßar por voc√™.");

    // Status
    const l1 = document.createElement("label");
    l1.className = "small";
    l1.innerHTML = 'Status acad√™mico/profissional <span class="req">*</span>';
    screenEl.appendChild(l1);

    const statusGrid = document.createElement("div");
    statusGrid.className = "grid";
    const statusOpts = ["Estudante", "Universit√°rio", "Formado", "Professor", "Empresa"];
    statusOpts.forEach(s => {
      statusGrid.appendChild(optionCard({
        type: "radio", name: "status", value: s, checked: state.status === s, title: s, id: "st_"+s,
        onChange: (e) => { state.status = e.target.value; save(); render(); }
      }));
    });
    screenEl.appendChild(statusGrid);

    // Nome
    const l2 = document.createElement("label");
    l2.className = "small";
    l2.innerHTML = 'Nome completo <span class="req">*</span>';
    const i2 = document.createElement("input");
    i2.type = "text";
    i2.placeholder = "Seu nome";
    i2.value = state.nome;
    i2.addEventListener("input", () => { state.nome = i2.value; save(); });
    screenEl.appendChild(l2);
    screenEl.appendChild(i2);

    // Email
    const l3 = document.createElement("label");
    l3.className = "small";
    l3.innerHTML = 'E-mail <span class="req">*</span>';
    const i3 = document.createElement("input");
    i3.type = "email";
    i3.placeholder = "seu@email.com";
    i3.value = state.email;
    i3.addEventListener("input", () => { state.email = i3.value; save(); });
    screenEl.appendChild(l3);
    screenEl.appendChild(i3);

    const isValid = state.status && state.nome && state.email.includes("@");
    renderActions({ canBack: false, canNext: isValid });
  }

  // --- 2. CONTEXTO ---
  function renderContexto(){
    renderHeader("Contexto da Apresenta√ß√£o", "Essencial para direcionar a linguagem.");

    // Tipo
    const l1 = document.createElement("label");
    l1.className = "small";
    l1.innerHTML = 'Tipo de apresenta√ß√£o <span class="req">*</span>';
    screenEl.appendChild(l1);
    
    const tipoGrid = document.createElement("div");
    tipoGrid.className = "grid";
    const tipos = ["Trabalho Escolar", "Semin√°rio", "TCC", "Aula", "Congresso", "Empresarial", "Entrevista", "Outro"];
    
    tipos.forEach(t => {
      tipoGrid.appendChild(optionCard({
        type: "radio", name: "tipo", value: t, checked: state.tipoApresentacao === t, title: t, id: "tp_"+t,
        onChange: (e) => { state.tipoApresentacao = e.target.value; save(); render(); }
      }));
    });
    screenEl.appendChild(tipoGrid);

    // Input condicional Tipo
    if(state.tipoApresentacao === "Outro"){
      const iOther = document.createElement("input");
      iOther.className = "hiddenInput show";
      iOther.type = "text";
      iOther.placeholder = "Descreva o tipo...";
      iOther.value = state.tipoApresentacaoOutro;
      iOther.addEventListener("input", ()=>{ state.tipoApresentacaoOutro = iOther.value; save(); });
      screenEl.appendChild(iOther);
    }

    // P√∫blico
    const l2 = document.createElement("label");
    l2.className = "small";
    l2.innerHTML = 'P√∫blico-alvo <span class="req">*</span>';
    screenEl.appendChild(l2);

    const pubGrid = document.createElement("div");
    pubGrid.className = "grid";
    const pubs = ["Professor", "Banca", "Alunos", "Clientes", "Investidores", "Outro"];
    pubs.forEach(p => {
      pubGrid.appendChild(optionCard({
        type: "radio", name: "publico", value: p, checked: state.publicoAlvo === p, title: p, id: "pb_"+p,
        onChange: (e) => { state.publicoAlvo = e.target.value; save(); render(); }
      }));
    });
    screenEl.appendChild(pubGrid);

    if(state.publicoAlvo === "Outro"){
      const iPubOther = document.createElement("input");
      iPubOther.className = "hiddenInput show";
      iPubOther.type = "text";
      iPubOther.placeholder = "Quem vai assistir?";
      iPubOther.value = state.publicoAlvoOutro;
      iPubOther.addEventListener("input", ()=>{ state.publicoAlvoOutro = iPubOther.value; save(); });
      screenEl.appendChild(iPubOther);
    }

    // N√≠vel
    const l3 = document.createElement("label");
    l3.className = "small";
    l3.innerHTML = 'N√≠vel de conhecimento do p√∫blico <span class="req">*</span>';
    screenEl.appendChild(l3);
    const nivGrid = document.createElement("div");
    nivGrid.className = "grid";
    ["Leigo", "Intermedi√°rio", "T√©cnico"].forEach(n => {
      nivGrid.appendChild(optionCard({
        type: "radio", name: "nivel", value: n, checked: state.nivelPublico === n, title: n, id: "nv_"+n,
        onChange: (e) => { state.nivelPublico = e.target.value; save(); render(); }
      }));
    });
    screenEl.appendChild(nivGrid);

    const validTipo = state.tipoApresentacao && (state.tipoApresentacao !== "Outro" || state.tipoApresentacaoOutro);
    const validPub = state.publicoAlvo && (state.publicoAlvo !== "Outro" || state.publicoAlvoOutro);
    const validNivel = !!state.nivelPublico;

    renderActions({ canBack: true, canNext: validTipo && validPub && validNivel });
  }

  // --- 3. CONTE√öDO ---
  function renderConteudo(){
    renderHeader("Conte√∫do", "O que vai nos slides.");

    // Tema
    const l1 = document.createElement("label");
    l1.className = "small";
    l1.innerHTML = 'Tema da apresenta√ß√£o <span class="req">*</span>';
    const i1 = document.createElement("input");
    i1.type = "text";
    i1.placeholder = "Ex.: Avan√ßos da IA na Medicina";
    i1.value = state.tema;
    i1.addEventListener("input", () => { state.tema = i1.value; save(); });
    screenEl.appendChild(l1);
    screenEl.appendChild(i1);

    // Objetivo
    const l2 = document.createElement("label");
    l2.className = "small";
    l2.innerHTML = 'Objetivo principal <span class="req">*</span>';
    screenEl.appendChild(l2);
    const objGrid = document.createElement("div");
    objGrid.className = "grid";
    const objs = ["Explicar", "Convencer", "Resumir", "Vender", "Ensinar", "Outro"];
    objs.forEach(o => {
      objGrid.appendChild(optionCard({
        type: "radio", name: "obj", value: o, checked: state.objetivo === o, title: o, id: "ob_"+o,
        onChange: (e) => { state.objetivo = e.target.value; save(); render(); }
      }));
    });
    screenEl.appendChild(objGrid);

    if(state.objetivo === "Outro"){
      const iObj = document.createElement("input");
      iObj.className = "hiddenInput show";
      iObj.type = "text";
      iObj.placeholder = "Qual o objetivo?";
      iObj.value = state.objetivoOutro;
      iObj.addEventListener("input", ()=>{ state.objetivoOutro = iObj.value; save(); });
      screenEl.appendChild(iObj);
    }

    // Slides
    const l3 = document.createElement("label");
    l3.className = "small";
    l3.innerHTML = 'Quantidade aproximada de slides <span class="req">*</span>';
    const i3 = document.createElement("input");
    i3.type = "number";
    i3.placeholder = "Ex.: 15";
    i3.value = state.qtdSlides;
    i3.addEventListener("input", () => { state.qtdSlides = i3.value; save(); });
    screenEl.appendChild(l3);
    screenEl.appendChild(i3);

    // Material
    const l4 = document.createElement("label");
    l4.className = "small";
    l4.innerHTML = 'Possui material base? <span class="muted">(marque os que tiver)</span> <span class="req">*</span>';
    screenEl.appendChild(l4);
    const matGrid = document.createElement("div");
    matGrid.className = "grid";
    ["N√£o", "Texto", "Word", "PDF", "Slides antigos"].forEach(m => {
      const isChecked = state.materialBase.includes(m);
      matGrid.appendChild(optionCard({
        type: "checkbox", name: "mat", value: m, checked: isChecked, title: m, id: "mt_"+m,
        onChange: (e) => {
          if(e.target.checked) state.materialBase.push(m);
          else state.materialBase = state.materialBase.filter(x => x !== m);
          save();
        }
      }));
    });
    screenEl.appendChild(matGrid);

    const validObj = state.objetivo && (state.objetivo !== "Outro" || state.objetivoOutro);
    const isValid = state.tema && validObj && state.qtdSlides && state.materialBase.length > 0;
    renderActions({ canBack: true, canNext: isValid });
  }

  // --- 4. DESIGN ---
  function renderDesign(){
    renderHeader("Estilo e Design", "O visual da sua apresenta√ß√£o.");

    // Op√ß√£o de cor
    const l1 = document.createElement("label");
    l1.className = "small";
    l1.innerHTML = 'Tem cores definidas? <span class="req">*</span>';
    screenEl.appendChild(l1);
    
    const colorCheckGrid = document.createElement("div");
    colorCheckGrid.className = "grid";
    colorCheckGrid.appendChild(optionCard({
      type: "radio", name: "temCor", value: "yes", checked: state.corDefinida === "yes", title: "Sim", id: "cor_y",
      onChange: (e) => { state.corDefinida = "yes"; save(); render(); }
    }));
    colorCheckGrid.appendChild(optionCard({
      type: "radio", name: "temCor", value: "no", checked: state.corDefinida === "no", title: "N√£o (Criar livre)", id: "cor_n",
      onChange: (e) => { state.corDefinida = "no"; save(); render(); }
    }));
    screenEl.appendChild(colorCheckGrid);

    // Inputs de cor (se sim)
    if(state.corDefinida === "yes"){
      const cBox = document.createElement("div");
      cBox.className = "hiddenInput show";
      cBox.style.background = "rgba(255,255,255,0.05)";
      cBox.style.padding = "10px";
      cBox.style.borderRadius = "12px";

      cBox.innerHTML = `
        <div style="display:flex; gap:10px; align-items:center; margin-bottom:8px">
          <div style="flex:1"><label class="small" style="margin:0">Fundo</label><input type="color" id="icFundo" value="${state.corFundo}"></div>
          <div style="flex:1"><label class="small" style="margin:0">Detalhes</label><input type="color" id="icDet" value="${state.corDetalhes}"></div>
          <div style="flex:1"><label class="small" style="margin:0">Fonte</label><input type="color" id="icFonte" value="${state.corFonte}"></div>
        </div>
      `;
      screenEl.appendChild(cBox);
      
      document.getElementById("icFundo").addEventListener("input", (e)=>{ state.corFundo = e.target.value; save(); });
      document.getElementById("icDet").addEventListener("input", (e)=>{ state.corDetalhes = e.target.value; save(); });
      document.getElementById("icFonte").addEventListener("input", (e)=>{ state.corFonte = e.target.value; save(); });
    }

    // Refer√™ncia visual
    const l2 = document.createElement("label");
    l2.className = "small";
    l2.innerHTML = 'Possui refer√™ncia visual? <span class="req">*</span>';
    screenEl.appendChild(l2);
    
    const refGrid = document.createElement("div");
    refGrid.className = "grid";
    refGrid.appendChild(optionCard({
      type: "radio", name: "ref", value: "yes", checked: state.referenciaVisual === "yes", title: "Sim", id: "ref_y",
      onChange: (e) => { state.referenciaVisual = "yes"; save(); render(); }
    }));
    refGrid.appendChild(optionCard({
      type: "radio", name: "ref", value: "no", checked: state.referenciaVisual === "no", title: "N√£o", id: "ref_n",
      onChange: (e) => { state.referenciaVisual = "no"; save(); render(); }
    }));
    screenEl.appendChild(refGrid);

    if(state.referenciaVisual === "yes"){
      const iLink = document.createElement("input");
      iLink.className = "hiddenInput show";
      iLink.type = "text";
      iLink.placeholder = "Cole o link aqui...";
      iLink.value = state.linkReferencia;
      iLink.addEventListener("input", ()=>{ state.linkReferencia = iLink.value; save(); });
      screenEl.appendChild(iLink);
    }

    const isValid = state.corDefinida && state.referenciaVisual && 
                    (state.referenciaVisual === "no" || state.linkReferencia);
    renderActions({ canBack: true, canNext: isValid });
  }

  // --- 5. PRAZO ---
  function renderPrazo(){
    renderHeader("Prazo e Urg√™ncia", "Para quando voc√™ precisa?");

    // Data
    const l1 = document.createElement("label");
    l1.className = "small";
    l1.innerHTML = 'Data de entrega desejada <span class="req">*</span>';
    const i1 = document.createElement("input");
    i1.type = "date";
    i1.value = state.dataEntrega;
    i1.addEventListener("input", () => { state.dataEntrega = i1.value; save(); render(); });
    screenEl.appendChild(l1);
    screenEl.appendChild(i1);

    // Urg√™ncia
    const l2 = document.createElement("label");
    l2.className = "small";
    l2.innerHTML = 'Grau de urg√™ncia <span class="req">*</span>';
    screenEl.appendChild(l2);
    
    const urgGrid = document.createElement("div");
    urgGrid.className = "grid";
    ["Normal", "Urgente", "Muito urgente"].forEach(u => {
      urgGrid.appendChild(optionCard({
        type: "radio", name: "urg", value: u, checked: state.urgencia === u, title: u, id: "ur_"+u,
        onChange: (e) => { state.urgencia = e.target.value; save(); render(); }
      }));
    });
    screenEl.appendChild(urgGrid);

    // Obs
    const l3 = document.createElement("label");
    l3.className = "small";
    l3.innerHTML = 'Observa√ß√µes livres (Algo importante?)';
    const i3 = document.createElement("textarea");
    i3.placeholder = "Digite aqui...";
    i3.value = state.observacoes;
    i3.addEventListener("input", () => { state.observacoes = i3.value; save(); });
    screenEl.appendChild(l3);
    screenEl.appendChild(i3);

    const isValid = state.dataEntrega && state.urgencia;
    renderActions({ canBack: true, canNext: isValid });
  }

  // --- 6. PAGAMENTO (NOVA ETAPA ANTES DO ENVIO) ---
  function renderPagamentoInfo(){
    renderHeader("Informa√ß√µes de Pagamento", "O valor √© personalizado e ser√° enviado ap√≥s o recebimento deste formul√°rio.");

    const box = document.createElement("div");
    box.className = "summary";
    box.style.marginBottom = "14px";
    
    let html = `<div style="margin-bottom:8px"><strong>Como funciona?</strong></div>`;
    html += `<div class="muted" style="margin-bottom:12px">Ap√≥s analisarmos os dados (complexidade, prazo e slides), o atendente enviar√° o or√ßamento oficial. Voc√™ poder√° escolher entre:</div>`;
    
    html += `<div style="margin-bottom:6px"><span class="tag orange"><b>PIX:</b> ${PIX_KEY}</span></div>`;
    
    html += `<div class="muted" style="margin-top:12px"><strong>Ou Cart√£o (com taxas):</strong></div>`;
    html += `<div class="grid" style="gap:4px; margin-top:4px">`;
    Object.keys(TAXAS).forEach(k => {
      html += `<div style="font-size:11px; color:#ccc">${k}x: ${TAXAS[k]}</div>`;
    });
    html += `</div>`;

    box.innerHTML = html;
    screenEl.appendChild(box);

    const btnPix = document.createElement("button");
    btnPix.type = "button";
    btnPix.className = "btn";
    btnPix.textContent = "Copiar chave PIX";
    btnPix.style.marginBottom = "14px";
    btnPix.addEventListener("click", copyPix);
    screenEl.appendChild(btnPix);

    const warn = document.createElement("p");
    warn.className = "muted";
    warn.textContent = "Clique em 'Revisar' para ver o resumo dos dados antes de enviar.";
    screenEl.appendChild(warn);

    renderActions({ canBack: true, canNext: true, nextLabel: "Revisar" });
  }

  // --- 7. RESUMO FINAL (REVIS√ÉO) ---
  function renderResumo(){
    renderHeader("Revisar e Enviar", "Confira as informa√ß√µes antes de enviar no WhatsApp.");

    // Gera o texto do resumo
    const summaryText = generateSummaryText();

    // Mostra na tela
    const box = document.createElement("div");
    box.className = "summary";
    box.textContent = summaryText;
    screenEl.appendChild(box);

    // Bot√£o Enviar
    const topActions = document.createElement("div");
    topActions.className = "actions left";

    const send = document.createElement("button");
    send.type = "button";
    send.className = "btn primary";
    send.textContent = "Enviar no WhatsApp";
    send.addEventListener("click", openWhatsApp);

    topActions.appendChild(send);
    screenEl.appendChild(topActions);
    
    const note = document.createElement("p");
    note.className = "muted";
    note.textContent = "Ao clicar, o WhatsApp abre com a mensagem pronta. Voc√™ s√≥ confirma o envio.";
    screenEl.appendChild(note);
    
    // Bot√£o Voltar (Separado para layout)
    const bottomActions = document.createElement("div");
    bottomActions.className = "actions left";
    bottomActions.style.marginTop = "20px";
    const back = document.createElement("button");
    back.type = "button";
    back.className = "btn";
    back.textContent = "Voltar";
    back.addEventListener("click", prevStep);
    bottomActions.appendChild(back);
    screenEl.appendChild(bottomActions);
  }

  // =========================
  // LOGICA DE TEXTO
  // =========================
  function generateSummaryText(){
    let txt = "*PRONTU√ÅRIO POWERPOINT - USO JALECO*\n-----------------------------\n";
    
    txt += `üë§ *IDENTIFICA√á√ÉO*\n`;
    txt += `Nome: ${state.nome}\n`;
    txt += `Email: ${state.email}\n`;
    txt += `Status: ${state.status}\n\n`;
    
    txt += `üìå *CONTEXTO*\n`;
    txt += `Tipo: ${state.tipoApresentacao}`;
    if(state.tipoApresentacaoOutro) txt += ` (${state.tipoApresentacaoOutro})`;
    txt += `\n`;
    
    txt += `P√∫blico: ${state.publicoAlvo}`;
    if(state.publicoAlvoOutro) txt += ` (${state.publicoAlvoOutro})`;
    txt += `\n`;
    
    txt += `N√≠vel: ${state.nivelPublico}\n\n`;
    
    txt += `üìÑ *CONTE√öDO*\n`;
    txt += `Tema: ${state.tema}\n`;
    txt += `Objetivo: ${state.objetivo}`;
    if(state.objetivoOutro) txt += ` (${state.objetivoOutro})`;
    txt += `\n`;
    txt += `Slides aprox.: ${state.qtdSlides}\n`;
    txt += `Material base: ${state.materialBase.join(", ") || "Nenhum"}\n\n`;
    
    txt += `üé® *DESIGN*\n`;
    if(state.corDefinida === "yes"){
      txt += `Cores: Fundo(${state.corFundo}), Detalhes(${state.corDetalhes}), Fonte(${state.corFonte})\n`;
    } else {
      txt += `Cores: Cria√ß√£o livre\n`;
    }
    
    if(state.referenciaVisual === "yes"){
      txt += `Ref: ${state.linkReferencia}\n`;
    } else {
      txt += `Ref: N√£o possui\n`;
    }
    
    txt += `\n‚è∞ *PRAZO*\n`;
    txt += `Entrega: ${state.dataEntrega ? state.dataEntrega.split('-').reverse().join('/') : '‚Äî'}\n`;
    txt += `Urg√™ncia: ${state.urgencia}\n`;
    if(state.observacoes) txt += `Obs: ${state.observacoes}\n`;
    
    txt += `\n-----------------------------\nAguardo o or√ßamento!`;
    return txt;
  }

  function openWhatsApp(){
    const url = "https://wa.me/" + WHATSAPP_NUMBER_E164 + "?text=" + encodeURIComponent(generateSummaryText());
    window.open(url, "_blank");
  }

  // Init
  render();
})();
</script>
</body>
</html>
